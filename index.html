<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>은사점검 테스트</title>
    <meta name="description" content="하나님이 주신 은사를 발견하는 테스트">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/recharts@2.5.0/dist/Recharts.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;
        const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar } = Recharts;

        const SpiritualGiftTest = () => {
          const [currentStep, setCurrentStep] = useState('intro');
          const [scores, setScores] = useState({
            affinity: Array(10).fill(0),
            ability: Array(10).fill(0),
            opportunity: Array(10).fill(0)
          });

          const giftTypes = [
            { id: 1, name: '긍휼', desc: '어려움을 겪는 사람들에게 깊이 공감하고 위로하는 능력' },
            { id: 2, name: '가르침', desc: '성경적 진리를 명확하게 설명하여 다른 사람을 교육하는 능력' },
            { id: 3, name: '행정', desc: '조직이나 행사를 계획하고 효율적으로 관리하는 능력' },
            { id: 4, name: '목양', desc: '사람들을 돌보고, 격려하며, 영적으로 성장하도록 돕는 능력' },
            { id: 5, name: '창조적', desc: '예술(음악, 미술 등)을 통해 하나님을 예배하고 표현하는 능력' },
            { id: 6, name: '구제', desc: '물질적 자원을 기쁘게 나누어 다른 사람을 돕는 능력' },
            { id: 7, name: '선교', desc: '다른 문화권이나 환경에 적응하여 복음을 전하는 능력' },
            { id: 8, name: '전도', desc: '비신자에게 복음을 명확하게 제시하여 결신을 돕는 능력' },
            { id: 9, name: '분별', desc: '진리와 거짓, 선과 악을 영적으로 분별하는 능력' },
            { id: 10, name: '지혜', desc: '복잡한 문제에 대한 실질적이고 효과적인 해결책을 제시하는 능력' }
          ];

          const questions = {
            affinity: [
              '어려움을 겪는 사람들의 이야기를 듣고, 그들의 아픔에 깊이 공감하는 것을 좋아한다.',
              '성경 말씀을 깊이 연구하고, 그 진리를 다른 사람들에게 쉽게 설명해 주는 데 흥미가 있다.',
              '교회 행사를 계획하고, 각 부서의 역할을 조율하는 등 전체 그림을 그리는 일을 즐긴다.',
              '다른 사람들이 자신의 잠재력을 발견하고 성장하도록 돕는 데 큰 기쁨을 느낀다.',
              '예술(음악, 미술, 글쓰기 등)을 통해 하나님을 표현하거나 예배 분위기를 조성하는 데 마음이 끌린다.',
              '누군가의 필요를 발견하면, 물질적이든 실질적인 도움이든 망설이지 않고 기꺼이 돕는다.',
              '전혀 새로운 환경이나 문화권에서 복음을 전하고 교회를 세우는 상상을 하곤 한다.',
              '비신자 친구들에게 기독교에 대해 자연스럽게 이야기할 기회를 항상 찾는다.',
              '영적으로 혼란스러워하는 사람들을 위해 진리와 거짓을 분별하고 올바른 길을 제시해 주고 싶다.',
              '교회의 재정을 투명하게 관리하고, 자원을 효율적으로 사용하는 것에 관심이 많다.'
            ],
            ability: [
              '당신의 위로와 격려를 통해 낙심했던 사람들이 다시 일어선 경험이 있다.',
              '당신의 가르침을 들은 사람들이 성경적 진리를 더 잘 이해하고 삶에 적용하는 것을 보았다.',
              '당신이 계획하고 조직한 행사가 성공적으로 잘 마무리되어 긍정적인 평가를 받은 적이 있다.',
              '당신의 조언과 리더십을 통해 공동체의 목표가 성공적으로 달성된 경험이 있다.',
              '당신이 만든 작품이나 음악이 예배 공동체에 깊은 영적 울림을 주었다.',
              '당신이 베푼 물질적 도움이나 봉사를 통해 상대방의 실제적인 문제가 해결된 적이 있다.',
              '낯선 사람들과 금방 친해지고, 그들이 편안함을 느끼도록 돕는 능력이 있다.',
              '당신의 간증이나 복음 제시를 통해 비신자가 예수 그리스도를 영접한 경험이 있다.',
              '영적인 문제가 발생했을 때, 당신의 통찰력으로 상황을 명확하게 파악하고 분별해냈다.',
              '복잡한 문제를 간단하고 효과적인 해결책으로 정리하여 제시하는 데 능숙하다.'
            ],
            opportunity: [
              '당신이 속한 소그룹에 마음의 어려움을 겪는 사람이 있어 위로가 필요하다.',
              '교회에 새롭게 등록한 성도들을 양육하고 가르쳐줄 사람이 필요하다.',
              '다음 세대를 위한 행사를 기획하고 운영할 팀원이 필요하다.',
              '소그룹 리더나 봉사팀 팀장처럼, 사람들을 이끌어 줄 리더가 필요하다.',
              '교회 예배나 찬양팀에서 창조적인 재능을 가진 사람을 찾고 있다.',
              '교회 주변에 어려운 이웃을 돕는 구제 사역을 시작하려 한다.',
              '해외 선교나 미전도 종족 사역에 동참할 사람을 찾고 있다.',
              '교회에 아직 믿지 않는 가족이나 친구를 둔 성도들이 많다.',
              '이단이나 잘못된 가르침에 대한 분별력을 길러줄 교육 프로그램이 필요하다.',
              '교회 행정이나 재정 관리를 담당할 봉사자가 필요하다.'
            ]
          };

          const handleScore = (category, index, score) => {
            setScores(prev => ({
              ...prev,
              [category]: prev[category].map((s, i) => i === index ? score : s)
            }));
          };

          const calculateTopGifts = (categoryScores) => {
            return categoryScores
              .map((score, index) => ({ giftId: index + 1, score }))
              .sort((a, b) => b.score - a.score)
              .slice(0, 3);
          };

          const getResults = () => {
            const topAffinity = calculateTopGifts(scores.affinity);
            const topAbility = calculateTopGifts(scores.ability);
            const topOpportunity = calculateTopGifts(scores.opportunity);

            const allGiftIds = [
              ...topAffinity.map(g => g.giftId),
              ...topAbility.map(g => g.giftId),
              ...topOpportunity.map(g => g.giftId)
            ];

            const giftFrequency = {};
            allGiftIds.forEach(id => {
              giftFrequency[id] = (giftFrequency[id] || 0) + 1;
            });

            const matchingGifts = Object.entries(giftFrequency)
              .filter(([_, count]) => count === 3)
              .map(([id]) => parseInt(id));

            return {
              topAffinity,
              topAbility,
              topOpportunity,
              matchingGifts,
              totalScores: scores.affinity.map((_, i) => ({
                gift: giftTypes[i].name,
                관심: scores.affinity[i],
                능력: scores.ability[i],
                기회: scores.opportunity[i]
              }))
            };
          };

          const renderIntro = () => (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 md:p-8">
              <div className="max-w-3xl mx-auto bg-white rounded-2xl shadow-xl p-6 md:p-10">
                <h1 className="text-3xl md:text-4xl font-bold text-center text-indigo-900 mb-6">
                  은사점검 테스트
                </h1>
                <div className="space-y-4 text-gray-700 leading-relaxed">
                  <p className="text-lg">
                    이 테스트는 정답을 찾는 시험이 아닙니다. 당신의 내면에 있는 하나님이 주신 은사를 발견하고, 
                    이를 통해 당신과 공동체가 함께 성장하는 기회를 찾기 위한 도구입니다.
                  </p>
                  <div className="bg-indigo-50 p-6 rounded-lg">
                    <h3 className="font-bold text-xl mb-3 text-indigo-900">평가 기준</h3>
                    <ul className="space-y-2">
                      <li><strong>5</strong> = 항상, 확실히 그렇다</li>
                      <li><strong>4</strong> = 대부분, 대체로 그렇다</li>
                      <li><strong>3</strong> = 보통 그렇다</li>
                      <li><strong>2</strong> = 때때로, 가끔 그렇다</li>
                      <li><strong>1</strong> = 전혀, 절대로 그렇지 않다</li>
                    </ul>
                  </div>
                  <div className="bg-blue-50 p-6 rounded-lg">
                    <h3 className="font-bold text-xl mb-3 text-blue-900">세 가지 영역</h3>
                    <ul className="space-y-2">
                      <li><strong>관심(Affinity)</strong> - 당신의 마음은 어디에 끌리나요?</li>
                      <li><strong>능력(Ability)</strong> - 당신의 재능은 무엇인가요?</li>
                      <li><strong>기회(Opportunity)</strong> - 공동체의 필요는 무엇인가요?</li>
                    </ul>
                  </div>
                </div>
                <button 
                  onClick={() => setCurrentStep('affinity')}
                  className="w-full mt-8 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-6 rounded-lg text-lg transition duration-200"
                >
                  테스트 시작하기
                </button>
              </div>
            </div>
          );

          const renderQuestions = (category, title, description) => {
            const categoryScores = scores[category];
            const progress = (categoryScores.filter(s => s > 0).length / 10) * 100;

            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 md:p-8">
                <div className="max-w-4xl mx-auto bg-white rounded-2xl shadow-xl p-6 md:p-10">
                  <div className="mb-8">
                    <h2 className="text-2xl md:text-3xl font-bold text-indigo-900 mb-2">{title}</h2>
                    <p className="text-gray-600">{description}</p>
                    <div className="mt-4 bg-gray-200 rounded-full h-3">
                      <div 
                        className="bg-indigo-600 h-3 rounded-full transition-all duration-300"
                        style={{ width: `${progress}%` }}
                      ></div>
                    </div>
                    <p className="text-sm text-gray-500 mt-2">{Math.round(progress)}% 완료</p>
                  </div>

                  <div className="space-y-6">
                    {questions[category].map((question, index) => (
                      <div key={index} className="border border-gray-200 rounded-lg p-4 md:p-6 hover:shadow-md transition">
                        <p className="font-medium text-gray-800 mb-4">
                          {index + 1}. {question}
                        </p>
                        <div className="flex flex-wrap gap-2 justify-center md:justify-start">
                          {[1, 2, 3, 4, 5].map(score => (
                            <button
                              key={score}
                              onClick={() => handleScore(category, index, score)}
                              className={`w-12 h-12 rounded-full font-bold transition ${
                                categoryScores[index] === score
                                  ? 'bg-indigo-600 text-white scale-110'
                                  : 'bg-gray-200 hover:bg-gray-300 text-gray-700'
                              }`}
                            >
                              {score}
                            </button>
                          ))}
                        </div>
                      </div>
                    ))}
                  </div>

                  <div className="flex flex-col md:flex-row gap-4 mt-8">
                    {category !== 'affinity' && (
                      <button
                        onClick={() => {
                          if (category === 'ability') setCurrentStep('affinity');
                          else if (category === 'opportunity') setCurrentStep('ability');
                        }}
                        className="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-4 px-6 rounded-lg transition"
                      >
                        이전
                      </button>
                    )}
                    <button
                      onClick={() => {
                        if (category === 'affinity') setCurrentStep('ability');
                        else if (category === 'ability') setCurrentStep('opportunity');
                        else setCurrentStep('result');
                      }}
                      disabled={categoryScores.some(s => s === 0)}
                      className={`flex-1 font-bold py-4 px-6 rounded-lg transition ${
                        categoryScores.some(s => s === 0)
                          ? 'bg-gray-300 text-gray-500 cursor-not-allowed'
                          : 'bg-indigo-600 hover:bg-indigo-700 text-white'
                      }`}
                    >
                      {category === 'opportunity' ? '결과 보기' : '다음'}
                    </button>
                  </div>
                </div>
              </div>
            );
          };

          const renderResults = () => {
            const results = getResults();

            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 md:p-8">
                <div className="max-w-6xl mx-auto bg-white rounded-2xl shadow-xl p-6 md:p-10">
                  <h2 className="text-3xl md:text-4xl font-bold text-center text-indigo-900 mb-8">
                    테스트 결과
                  </h2>

                  {results.matchingGifts.length > 0 && (
                    <div className="mb-8 p-6 bg-green-50 border-2 border-green-500 rounded-xl">
                      <h3 className="text-2xl font-bold text-green-800 mb-4">
                        🎯 완벽하게 일치하는 은사!
                      </h3>
                      <div className="space-y-3">
                        {results.matchingGifts.map(giftId => {
                          const gift = giftTypes[giftId - 1];
                          return (
                            <div key={giftId} className="bg-white p-4 rounded-lg">
                              <h4 className="font-bold text-xl text-green-700">{gift.name}</h4>
                              <p className="text-gray-600">{gift.desc}</p>
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  )}

                  <div className="grid md:grid-cols-3 gap-6 mb-8">
                    <div className="bg-blue-50 p-6 rounded-xl">
                      <h3 className="text-xl font-bold text-blue-900 mb-4">관심 (Affinity)</h3>
                      <div className="space-y-2">
                        {results.topAffinity.map((item, index) => (
                          <div key={index} className="bg-white p-3 rounded-lg">
                            <div className="font-bold">{index + 1}. {giftTypes[item.giftId - 1].name}</div>
                            <div className="text-sm text-gray-600">점수: {item.score}</div>
                          </div>
                        ))}
                      </div>
                    </div>

                    <div className="bg-purple-50 p-6 rounded-xl">
                      <h3 className="text-xl font-bold text-purple-900 mb-4">능력 (Ability)</h3>
                      <div className="space-y-2">
                        {results.topAbility.map((item, index) => (
                          <div key={index} className="bg-white p-3 rounded-lg">
                            <div className="font-bold">{index + 1}. {giftTypes[item.giftId - 1].name}</div>
                            <div className="text-sm text-gray-600">점수: {item.score}</div>
                          </div>
                        ))}
                      </div>
                    </div>

                    <div className="bg-orange-50 p-6 rounded-xl">
                      <h3 className="text-xl font-bold text-orange-900 mb-4">기회 (Opportunity)</h3>
                      <div className="space-y-2">
                        {results.topOpportunity.map((item, index) => (
                          <div key={index} className="bg-white p-3 rounded-lg">
                            <div className="font-bold">{index + 1}. {giftTypes[item.giftId - 1].name}</div>
                            <div className="text-sm text-gray-600">점수: {item.score}</div>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>

                  <div className="mb-8">
                    <h3 className="text-2xl font-bold text-gray-800 mb-4 text-center">전체 은사 프로필</h3>
                    <ResponsiveContainer width="100%" height={400}>
                      <RadarChart data={results.totalScores}>
                        <PolarGrid />
                        <PolarAngleAxis dataKey="gift" />
                        <PolarRadiusAxis angle={90} domain={[0, 5]} />
                        <Radar name="관심" dataKey="관심" stroke="#3b82f6" fill="#3b82f6" fillOpacity={0.3} />
                        <Radar name="능력" dataKey="능력" stroke="#8b5cf6" fill="#8b5cf6" fillOpacity={0.3} />
                        <Radar name="기회" dataKey="기회" stroke="#f59e0b" fill="#f59e0b" fillOpacity={0.3} />
                        <Legend />
                      </RadarChart>
                    </ResponsiveContainer>
                  </div>

                  <div className="bg-indigo-50 p-6 rounded-xl mb-8">
                    <h3 className="text-2xl font-bold text-indigo-900 mb-4">결과 해석</h3>
                    <div className="space-y-4 text-gray-700">
                      <p>
                        세 영역(관심, 능력, 기회)이 모두 일치하는 은사가 있다면, 이것이 현재 당신이 
                        가장 효과적으로 사용할 수 있는 은사입니다.
                      </p>
                      <p>
                        일치하지 않는 경우에도 괜찮습니다. 각 영역의 상위 은사들을 통해 당신의 
                        영적 여정과 성장 방향을 발견할 수 있습니다.
                      </p>
                      <ul className="list-disc list-inside space-y-2 ml-4">
                        <li><strong>관심만 높은 경우:</strong> 배움과 훈련의 기회로 삼으세요</li>
                        <li><strong>능력만 높은 경우:</strong> 섬김의 기회로 여기며 영적 동기를 구하세요</li>
                        <li><strong>기회만 있는 경우:</strong> 새로운 도전과 성장의 기회입니다</li>
                      </ul>
                    </div>
                  </div>

                  <button
                    onClick={() => {
                      setCurrentStep('intro');
                      setScores({
                        affinity: Array(10).fill(0),
                        ability: Array(10).fill(0),
                        opportunity: Array(10).fill(0)
                      });
                    }}
                    className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-6 rounded-lg transition"
                  >
                    처음으로 돌아가기
                  </button>
                </div>
              </div>
            );
          };

          if (currentStep === 'intro') return renderIntro();
          if (currentStep === 'affinity') return renderQuestions('affinity', '관심 (Affinity)', '당신의 마음은 어디에 끌리나요?');
          if (currentStep === 'ability') return renderQuestions('ability', '능력 (Ability)', '당신의 재능은 무엇인가요?');
          if (currentStep === 'opportunity') return renderQuestions('opportunity', '기회 (Opportunity)', '공동체의 필요는 무엇인가요?');
          if (currentStep === 'result') return renderResults();
        };

        ReactDOM.render(<SpiritualGiftTest />, document.getElementById('root'));
    </script>
</body>
</html>